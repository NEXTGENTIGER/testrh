version: "3.8"

services:
  openvas:
    image: immauss/openvas:latest  # OpenVAS libre
    container_name: openvas
    ports:
      - "443:9392"
    environment:
      - PASSWORD=admin
      - USERNAME=admin
      - SMTPPORT=25
      - REDISDBS=512
      - QUIET=false
      - NEWDB=false
      - SKIPSYNC=true
      - RESTORE=false
      - DEBUG=false
      - GMP=9390
    volumes:
      - openvas:/data
    restart: unless-stopped
    shm_size: "2gb"  # recommandé pour OpenVAS

  wireshark:
    image: lscr.io/linuxserver/wireshark:latest  # Image libre Wireshark (nécessite configuration X11 pour GUI)
    container_name: wireshark
    restart: unless-stopped
    environment:
      - PUID=1000
      - PGID=1000
    volumes:
      - /tmp/.X11-unix:/tmp/.X11-unix
      - wireshark-config:/config
    devices:
      - /dev/bus/usb:/dev/bus/usb
    network_mode: host
    cap_add:
      - NET_ADMIN
      - NET_RAW
    environment:
      - DISPLAY=$DISPLAY

  msf:
    image: metasploitframework/metasploit-framework:latest  # Image officielle Metasploit Framework
    container_name: msf
    restart: unless-stopped
    tty: true
    stdin_open: true
    command: tail -f /dev/null

  hydra:
    image: trustedsec/commando-vm:latest  # Contient Hydra, mais un peu lourd
    container_name: hydra
    restart: unless-stopped
    tty: true
    stdin_open: true
    command: tail -f /dev/null

volumes:
  openvas:
  wireshark-config:
